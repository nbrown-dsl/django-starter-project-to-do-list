<!--html template with django code snippets-->


{% extends 'base.html' %}
{% load static %}
{%load crispy_forms_tags %}

{% block title %}My Skills{% endblock %}


{% block content %}

    <h2>My skills</h2>

    <form action="/mycomps/" method="POST">
      {% csrf_token %}
      {{form|crispy}}
      <br>
      <button class="btn btn-primary" type="submit">Filter</button>
      <a role="button" class="btn btn-secondary" href="{% url 'mycomps' %}">Clear</a>
    </form>
    <br>
    

  <table class="table table-dark">
        <!-- <tr class="table-primary">
            <th></th>
            <th></th>
            <th></th>
          </tr> -->         
          <!--iterates through instances of class-->     
      {% for obj in objects %}         
              <tr><td>
                
                <div class="btn-group" role="group" aria-label="Basic example">
               <label class="container"> 
                  {% if obj.userGrade.value > 0 %}<input class="star" type="checkbox" id="check{{obj.id}}" usertask_id = "{{ obj.id }}" grade_value=1  checked >
                  {% else %} 
                  <input class="star" type="checkbox" id="check{{obj.id}}" usertask_id = "{{ obj.id }}" grade_value=1  unchecked >
                   {% endif %}
                  <span class="starmark"></span>
                </label>
                <label class="container">
                  {% if obj.userGrade.value > 1 %}<input class="star" type="checkbox" id="check{{obj.id}}" usertask_id = "{{ obj.id }}" grade_value=2  checked >
                  {% else %} 
                  <input class="star" type="checkbox" id="check{{obj.id}}" usertask_id = "{{ obj.id }}" grade_value=2 unchecked >
                   {% endif %}
                  <span class="starmark"></span>
                </label>
                <label class="container">
                  {% if obj.userGrade.value > 2 %}<input class="star" type="checkbox" id="check{{obj.id}}" usertask_id = "{{ obj.id }}" grade_value=3  checked >
                  {% else %} 
                  <input class="star" type="checkbox" id="check{{obj.id}}" usertask_id = "{{ obj.id }}" grade_value=3  unchecked >
                   {% endif %}
                  <span class="starmark"></span>
                </label>
              </div>
                
                
              </td>                 
                  <td style="width:85%">{{obj.usertasktask.description}} </td>
                  <td><center><a href="{{ obj.usertasktask.link}}" target="_blank"><i class="bi bi-info-square"></i></a></center></td>
                  <td><center><a href="{{ obj.usertasktask.system.link}}" target="_blank"><img src="{% static obj.usertasktask.system.imgFileName %}" width="24"></i></a></center></td>
              </tr>
      {% endfor %}
  </table>  



</script>
<!--ajax call to server to update grade change without reloading page-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script type="text/javascript">
  $('.star').click(function(){
  var grade_val;
  var usertask_id;
  usertask_id = $(this).attr("usertask_id");
  grade_val = $(this).attr("grade_value");
  $.ajax(
  {
      type:"GET",
      url: '/gradeChange/',
      data:{
               grade_value: grade_val,
               usertask_id: usertask_id
      },
      success: function( data ) 
      {
          // $( '#check'+ catid ).remove();
          $( '#message' ).text(data);
      }
   })
  });
</script>

{% endblock %}